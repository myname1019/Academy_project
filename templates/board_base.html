{% load static %}
<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TiKiTaKa - ë¼ì´í”„íƒ€ì„ ì»¤ë¦¬ì–´ í”Œë«í¼</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="{% static 'css/style.css' %}">

    {% if user.is_authenticated and user.is_password_expired %}
    <div id="pw-warning-banner" style="position: relative; background-color: #ffeaa7; color: #d63031; padding: 15px; text-align: center; font-weight: bold; font-size: 15px; border-bottom: 2px solid #fdcb6e;">
        ğŸš¨ íšŒì›ë‹˜ì˜ ë¹„ë°€ë²ˆí˜¸ë¥¼ ë³€ê²½í•œ ì§€ 90ì¼ì´ ì§€ë‚¬ìŠµë‹ˆë‹¤. ì†Œì¤‘í•œ ê°œì¸ì •ë³´ ë³´í˜¸ë¥¼ ìœ„í•´ ë¹„ë°€ë²ˆí˜¸ë¥¼ ë³€ê²½í•´ ì£¼ì„¸ìš”! 
        <a href="{% url 'common:password_change' %}" style="margin-left: 15px; background: #d63031; color: white; padding: 5px 12px; border-radius: 5px; text-decoration: none;">
            ë¹„ë°€ë²ˆí˜¸ ë³€ê²½í•˜ëŸ¬ ê°€ê¸°
        </a>
        
        <button onclick="closePwWarning()" style="position: absolute; right: 20px; top: 50%; transform: translateY(-50%); background: none; border: none; font-size: 24px; font-weight: bold; color: #d63031; cursor: pointer; line-height: 1;" title="ì˜¤ëŠ˜ í•˜ë£¨ ë³´ì§€ ì•Šê¸°">
            &times;
        </button>
    </div>

    <script>
        document.addEventListener("DOMContentLoaded", function() {
            // ë¸Œë¼ìš°ì € ê¸°ì–µ ì¥ì¹˜ì— 'ìˆ¨ê¹€' í‘œì‹œê°€ ìˆë‹¤ë©´, ì•„ì˜ˆ í™”ë©´ì— ê·¸ë¦¬ì§€ ì•ŠìŠµë‹ˆë‹¤.
            if (sessionStorage.getItem('hide_pw_warning') === 'true') {
                document.getElementById('pw-warning-banner').style.display = 'none';
            }
        });

        function closePwWarning() {
            // 1. ë‹¹ì¥ ëˆˆì•ì—ì„œ ìˆ¨ê¹ë‹ˆë‹¤.
            document.getElementById('pw-warning-banner').style.display = 'none';
            // 2. ë¸Œë¼ìš°ì €ì—ê²Œ "ì´ ì°½ ë‹«í ë•Œê¹Œì§€ ë‹¤ì‹œ ë„ìš°ì§€ ë§ˆ!" ë¼ê³  ë©”ëª¨ë¥¼ ë‚¨ê¹ë‹ˆë‹¤.
            sessionStorage.setItem('hide_pw_warning', 'true');
        }
    </script>
    {% endif %}
    {% block extra_css %}
    {% endblock %}
</head>

<body>
    {% include "board_navbar.html" %}
    
    {% block content %}
    {% endblock %}

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>

    {% block script %}
    {% endblock %}
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    {% if messages %}
        <script>
            // ì—¬ëŸ¬ ê°œì˜ ë©”ì‹œì§€ê°€ ìˆì„ ìˆ˜ ìˆìœ¼ë‹ˆ ë°˜ë³µë¬¸ìœ¼ë¡œ ì²˜ë¦¬í•©ë‹ˆë‹¤
            {% for message in messages %}
                
                // ì¥ê³ ì˜ íƒœê·¸(danger, success ë“±)ë¥¼ íŒì—…ì°½ ì•„ì´ì½˜(error, success ë“±)ìœ¼ë¡œ ë³€í™˜
                let iconType = 'info';
                let msgTag = '{{ message.tags }}';
                
                if (msgTag.includes('danger')) { iconType = 'error'; }
                else if (msgTag.includes('success')) { iconType = 'success'; }
                else if (msgTag.includes('warning')) { iconType = 'warning'; }

                // ì˜ˆìœ íŒì—…ì°½ ë„ìš°ê¸°!
                Swal.fire({
                    icon: iconType,
                    title: 'ì•Œë¦¼',
                    text: '{{ message }}',
                    confirmButtonColor: '#6c5ce7', // TikiTaka ë³´ë¼ìƒ‰ í…Œë§ˆì— ë§ì¶¤!
                    confirmButtonText: 'í™•ì¸'
                });
                
            {% endfor %}
        </script>
    {% endif %}


</body>
</html>