{% load static %}
<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}강의 관리 시스템{% endblock %}</title>
    <link rel="stylesheet" href="{% static '/base/css/base.css' %}">
    {% block extra_css %}{% endblock %}
</head>

<body>
    <header class="navbar">
        <div class="logo">
            <a href="/" style="margin-left: 5px;">TiKiTaKa</a>
        </div>

        <nav>
            {% if user.is_authenticated and user.role == 'teacher' %}
                <a href="{% url 'course:my_courses' %}">내 강의 목록</a>
                <a href="{% url 'course:course_create' %}" class="btn-primary">새 강의 등록</a>
            {% elif user.is_authenticated and user.role == 'student' %}
                <a href="{% url 'course:my_enrollments' %}">내 강의 목록</a>
            {% else %}
                <a href="{% url 'course:course_list' %}">강의 목록</a>
            {% endif %}

            {# ✅ "진짜 마이페이지(학생/선생 대시보드)"에서는 내 페이지 링크 숨김 #}
            {% with vn=request.resolver_match.view_name %}
                {% if user.is_authenticated %}
                    {# 학생: studentpage 네임스페이스를 쓰는 경우 #}
                    {% if user.role == 'student' and vn != 'studentpage:student_dashboard' %}
                        <a href="{% url 'common:mypage' %}">내 페이지</a>

                    {# 선생: teacherpage 대시보드 #}
                    {% elif user.role == 'teacher' and vn != 'teacherpage:dashboard' %}
                        <a href="{% url 'common:mypage' %}">내 페이지</a>

                    {# 로그인했지만 role이 없거나 다른 값이면 일단 보여주기 #}
                    {% elif user.role != 'student' and user.role != 'teacher' %}
                        <a href="{% url 'common:mypage' %}">내 페이지</a>
                    {% endif %}
                {% endif %}
            {% endwith %}
        </nav>
    </header>

    <main class="main-container">
        {% if messages %}
        <div class="messages-container">
            {% for message in messages %}
            <div class="alert alert-{{ message.tags }}" role="alert">
                <button type="button" class="close-btn" onclick="this.parentElement.style.display='none';">&times;</button>
                {{ message }}
            </div>
            {% endfor %}
        </div>
        {% endif %}

        {% block content %}{% endblock %}
    </main>

    <footer class="footer">
        <p>&copy; 2026 My Academy | Course Management System</p>
    </footer>

    {% block extra_js %}{% endblock %}
</body>
</html>